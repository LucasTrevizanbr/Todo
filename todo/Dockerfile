FROM maven:3.8.5-openjdk-17

ARG DB_URL_BUILD="jdbc:mysql://db/db:3308/todo"
ARG DB_USERNAME_BUILD="teste"
ARG DB_PASSWORD_BUILD="teste"
ARG JWT_SECRET_BUILD="teste"
ARG MAIL_USERNAME_BUILD="teste"
ARG MAIL_PASSWORD_BUILD="teste"

ENV DB_URL=$DB_URL_BUILD
ENV DB_USERNAME=$DB_USERNAME_BUILD
ENV DB_PASSWORD=$DB_PASSWORD_BUILD
ENV JWT_SECRET=$JWT_SECRET_BUILD
ENV MAIL_USERNAME=$MAIL_USERNAME_BUILD
ENV MAIL_PASSWORD=$MAIL_PASSWORD_BUILD

WORKDIR /app/todo
COPY . .
RUN mvn clean package
ENTRYPOINT ["java", "-jar", "/app/todo/target/*.jar", "DDB_URL=$DB_URL", "DDB_USERNAME=$DB_USERNAME", "DDB_PASSWORD=$DB_PASSWORD", "DJWT_SECRET=$JWT_SECRET","DMAIL_USERNAME=$MAIL_USERNAME","DMAIL_PASSWORD=$MAIL_PASSWORD"]